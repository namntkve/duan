<!DOCTYPE html>
<html lang="vi">
 <head>
  <!-- =========================================================
       Project Management System - Enhanced CRM
       New Features:
       - Tasks management with project autofill
       - Weekly reports
       - User task summary
       - Project manager summary
       ========================================================= -->
  <meta charset="utf-8"/>
  <meta content="width=device-width,initial-scale=1" name="viewport"/>
  <title>
   Project Management System &bull; Bootstrap Admin
  </title>
  <!-- Bootstrap 5 CSS -->
  <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" rel="stylesheet"/>
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
   <!-- Supabase JS v2 (UMD) -->
   <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js">
   </script>
   <link href="style.css" rel="stylesheet"/>
  </link>
  <meta content="Project Management System &ndash; Enhanced CRM" name="description"/>
  <meta content="#0d6efd" name="theme-color"/>
 </head>
 <body>
  <!-- ===== AUTH OVERLAY (Google + whitelist user_profiles) ===== -->
  <div class="auth-overlay d-none" id="authOverlay">
   <div class="card auth-card">
    <div class="card-body text-center p-4">
     <div class="mb-3">
      <i class="bi bi-shield-lock" style="font-size:2.5rem;">
      </i>
     </div>
     <h5 class="fw-bold mb-2">
      &Dstrok;&abreve;ng nhập Project Management
     </h5>
     <p class="text-muted small mb-4">
      Chỉ chấp nhận email nằm trong bảng
      <code>
       user_profiles
      </code>
      v&agrave;
      <code>
       active = true
      </code>
      .
     </p>
     <button class="btn btn-dark w-100 mb-2" id="btnGoogle" type="button">
      <i class="bi bi-google me-2">
      </i>
      &Dstrok;&abreve;ng nhập với Google
     </button>
     <div class="text-danger small mt-2" id="authError">
     </div>
    </div>
   </div>
  </div>
  <!-- ========================= SIDEBAR ========================= -->
  <aside class="sidebar p-3">
   <a class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-decoration-none">
    <span class="fs-5 fw-bold">
     <i class="bi bi-kanban me-2">
     </i>
     Project Management
    </span>
   </a>
   <hr/>
   <ul class="nav nav-pills flex-column gap-1" id="sidebarNav">
    <li class="nav-item">
     <a class="nav-link active" data-page="dashboard">
      <i class="bi bi-speedometer2 me-2">
      </i>
      Dashboard
     </a>
    </li>
    <li class="nav-item">
     <a class="nav-link" data-page="users">
      <i class="bi bi-person-gear me-2">
      </i>
      Users
     </a>
    </li>
    <li class="nav-item">
     <a class="nav-link" data-page="projects">
      <i class="bi bi-kanban me-2">
      </i>
      Projects
     </a>
    </li>
    <li class="nav-item">
     <a class="nav-link" data-page="clients">
      <i class="bi bi-people me-2">
      </i>
      Clients
     </a>
    </li>
    <li class="nav-item">
     <a class="nav-link" data-page="contracts">
      <i class="bi bi-file-earmark-text me-2">
      </i>
      Contracts
     </a>
    </li>
    <li class="nav-item">
     <a class="nav-link" data-page="tasks">
      <i class="bi bi-check2-square me-2">
      </i>
      Tasks
     </a>
    </li>
    <li class="nav-item">
     <a class="nav-link" data-page="weekly-report">
      <i class="bi bi-calendar-week me-2">
      </i>
      Weekly Report
     </a>
    </li>
    <li class="nav-item">
     <a class="nav-link" data-page="user-summary">
      <i class="bi bi-person-check me-2">
      </i>
      My Tasks
     </a>
    </li>
    <li class="nav-item">
     <a class="nav-link" data-page="project-summary" id="navProjectSummary">
      <i class="bi bi-graph-up me-2">
      </i>
      Project Summary
     </a>
    </li>
   </ul>
   <hr/>
   <div class="dropdown">
    <a class="d-flex align-items-center text-decoration-none dropdown-toggle" data-bs-toggle="dropdown">
     <img alt="Avatar người d&ugrave;ng" class="rounded-circle me-2" height="32" src="https://ui-avatars.com/api/?name=PM&amp;background=0D6EFD&amp;color=fff" width="32"/>
     <strong id="currentEmail">
      guest@local
     </strong>
    </a>
    <ul class="dropdown-menu shadow">
     <li>
      <a class="dropdown-item" href="#" id="btnSignOut">
       <i class="bi bi-box-arrow-right me-2">
       </i>
       &Dstrok;&abreve;ng xuất
      </a>
     </li>
    </ul>
   </div>
  </aside>
  <!-- ========================= MAIN ========================= -->
  <main class="content-wrap">
   <div class="container-fluid py-4">
    <!-- DASHBOARD -->
    <section class="section-anchor" id="page-dashboard">
     <div class="d-flex align-items-center mb-4">
      <h1 class="h3 mb-0">
       <i class="bi bi-speedometer2 me-2">
       </i>
       Dashboard
      </h1>
     </div>
     <div class="row g-4">
      <div class="col-12 col-sm-6 col-lg-3">
       <div class="card card-shadow">
        <div class="card-body">
         <h6 class="text-secondary text-uppercase mb-1">
          Users
         </h6>
         <h2 class="fw-bold mb-0" id="kpiUsers">
          0
         </h2>
        </div>
       </div>
      </div>
      <div class="col-12 col-sm-6 col-lg-3">
       <div class="card card-shadow">
        <div class="card-body">
         <h6 class="text-secondary text-uppercase mb-1">
          Projects
         </h6>
         <h2 class="fw-bold mb-0" id="kpiProjects">
          0
         </h2>
        </div>
       </div>
      </div>
      <div class="col-12 col-sm-6 col-lg-3">
       <div class="card card-shadow">
        <div class="card-body">
         <h6 class="text-secondary text-uppercase mb-1">
          Clients
         </h6>
         <h2 class="fw-bold mb-0" id="kpiClients">
          0
         </h2>
        </div>
       </div>
      </div>
      <div class="col-12 col-sm-6 col-lg-3">
       <div class="card card-shadow">
        <div class="card-body">
         <h6 class="text-secondary text-uppercase mb-1">
          Tasks
         </h6>
         <h2 class="fw-bold mb-0" id="kpiTasks">
          0
         </h2>
        </div>
       </div>
      </div>
     </div>
     <div class="row g-4 mt-2">
      <div class="col-12 col-md-6">
       <div class="card card-shadow">
        <div class="card-body">
         <h6 class="text-secondary text-uppercase mb-3">
          Task Status Overview
         </h6>
         <div class="d-flex justify-content-between mb-2">
          <span>
           Pending
          </span>
          <span class="fw-bold" id="kpiTasksPending">
           0
          </span>
         </div>
         <div class="d-flex justify-content-between mb-2">
          <span>
           In Progress
          </span>
          <span class="fw-bold" id="kpiTasksInProgress">
           0
          </span>
         </div>
         <div class="d-flex justify-content-between">
          <span>
           Completed
          </span>
          <span class="fw-bold" id="kpiTasksCompleted">
           0
          </span>
         </div>
        </div>
       </div>
      </div>
      <div class="col-12 col-md-6">
       <div class="card card-shadow">
        <div class="card-body">
         <h6 class="text-secondary text-uppercase mb-3">
          Project Status Overview
         </h6>
         <div class="d-flex justify-content-between mb-2">
          <span>
           Active
          </span>
          <span class="fw-bold" id="kpiProjectsActive">
           0
          </span>
         </div>
         <div class="d-flex justify-content-between mb-2">
          <span>
           On Hold
          </span>
          <span class="fw-bold" id="kpiProjectsOnHold">
           0
          </span>
         </div>
         <div class="d-flex justify-content-between">
          <span>
           Completed
          </span>
          <span class="fw-bold" id="kpiProjectsCompleted">
           0
          </span>
         </div>
        </div>
       </div>
      </div>
     </div>
    </section>
    <!-- USERS -->
    <section class="section-anchor d-none" id="page-users">
     <div class="d-flex align-items-center mb-4">
      <h1 class="h3 mb-0">
       <i class="bi bi-person-gear me-2">
       </i>
       Users
      </h1>
      <div class="ms-auto">
       <button class="btn btn-primary" id="btnAddUser" type="button">
        <i class="bi bi-plus-lg me-1">
        </i>
        Th&ecirc;m user
       </button>
      </div>
     </div>
     <div class="d-none" id="userFormWrap">
     </div>
     <div class="card card-shadow">
      <div class="card-body table-responsive">
       <table class="table table-hover table-sm align-middle">
        <thead class="table-light">
         <tr>
          <th>
           Email
          </th>
          <th>
           Role
          </th>
          <th>
           Active
          </th>
          <th style="width:140px;">
           Actions
          </th>
         </tr>
        </thead>
        <tbody id="userTbody">
        </tbody>
       </table>
      </div>
     </div>
    </section>
    <!-- PROJECTS -->
    <section class="section-anchor d-none" id="page-projects">
     <div class="d-flex align-items-center mb-4">
      <h1 class="h3 mb-0">
       <i class="bi bi-kanban me-2">
       </i>
       Projects
      </h1>
      <div class="ms-auto">
       <button class="btn btn-primary" id="btnAddProject" type="button">
        <i class="bi bi-plus-lg me-1">
        </i>
        Th&ecirc;m dự &aacute;n
       </button>
      </div>
     </div>
     <div class="d-none" id="projectFormWrap">
     </div>
     <div class="card card-shadow">
      <div class="card-body table-responsive">
       <table class="table table-hover table-sm align-middle">
        <thead class="table-light">
         <tr>
          <th>
           ID
          </th>
          <th>
           T&ecirc;n dự &aacute;n
          </th>
          <th>
           Kh&aacute;ch h&agrave;ng
          </th>
          <th>
           Start
          </th>
          <th>
           End
          </th>
          <th>
           Status
          </th>
          <th style="width:120px;">
           Actions
          </th>
         </tr>
        </thead>
        <tbody id="projectTbody">
        </tbody>
       </table>
      </div>
     </div>
    </section>
    <!-- CLIENTS -->
    <section class="section-anchor d-none" id="page-clients">
     <div class="d-flex align-items-center mb-4">
      <h1 class="h3 mb-0">
       <i class="bi bi-people me-2">
       </i>
       Clients
      </h1>
      <div class="ms-auto">
       <button class="btn btn-primary" id="btnAddClient" type="button">
        <i class="bi bi-plus-lg me-1">
        </i>
        Th&ecirc;m kh&aacute;ch h&agrave;ng
       </button>
      </div>
     </div>
     <div class="d-none" id="clientFormWrap">
     </div>
     <div class="card card-shadow">
      <div class="card-body table-responsive">
       <table class="table table-hover table-sm align-middle">
        <thead class="table-light">
         <tr>
          <th>
           ID
          </th>
          <th>
           Name
          </th>
          <th>
           Contact
          </th>
          <th>
           Phone
          </th>
          <th>
           Email
          </th>
          <th>
           Tax
          </th>
          <th style="width:120px;">
           Actions
          </th>
         </tr>
        </thead>
        <tbody id="clientTbody">
        </tbody>
       </table>
      </div>
     </div>
    </section>
    <!-- CONTRACTS -->
    <section class="section-anchor d-none" id="page-contracts">
     <div class="d-flex align-items-center mb-4">
      <h1 class="h3 mb-0">
       <i class="bi bi-file-earmark-text me-2">
       </i>
       Contracts
      </h1>
      <div class="ms-auto">
       <button class="btn btn-primary" id="btnAddContract" type="button">
        <i class="bi bi-plus-lg me-1">
        </i>
        Th&ecirc;m hợp &dstrok;ồng
       </button>
      </div>
     </div>
     <div class="d-none" id="contractFormWrap">
     </div>
     <div class="card card-shadow">
      <div class="card-body table-responsive">
       <table class="table table-hover table-sm align-middle">
        <thead class="table-light">
         <tr>
          <th>
           ID
          </th>
          <th>
           Dự &aacute;n
          </th>
          <th>
           Kh&aacute;ch h&agrave;ng
          </th>
          <th>
           Gi&aacute; trị
          </th>
          <th>
           Status
          </th>
          <th style="width:140px;">
           Actions
          </th>
         </tr>
        </thead>
        <tbody id="contractTbody">
        </tbody>
       </table>
      </div>
     </div>
    </section>
    <!-- TASKS -->
    <section class="section-anchor d-none" id="page-tasks">
     <div class="d-flex align-items-center mb-4">
      <h1 class="h3 mb-0">
       <i class="bi bi-check2-square me-2">
       </i>
       Tasks
      </h1>
      <div class="ms-auto">
       <button class="btn btn-primary" id="btnAddTask" type="button">
        <i class="bi bi-plus-lg me-1">
        </i>
        Th&ecirc;m task
       </button>
      </div>
     </div>
     <div class="d-none" id="taskFormWrap">
     </div>
     <div class="card card-shadow">
      <div class="card-body table-responsive">
       <table class="table table-hover table-sm align-middle">
        <thead class="table-light">
         <tr>
          <th>
           ID
          </th>
          <th>
           T&ecirc;n Task
          </th>
          <th>
           Dự &aacute;n
          </th>
          <th>
           Người thực hiện
          </th>
          <th>
           Tổng thời gian (h)
          </th>
          <th>
           &Dstrok;&atilde; thực hiện (h)
          </th>
          <th>
           T&igrave;nh trạng
          </th>
          <th>
           Deadline
          </th>
          <th style="width:140px;">
           Actions
          </th>
         </tr>
        </thead>
        <tbody id="taskTbody">
        </tbody>
       </table>
      </div>
     </div>
    </section>
    <!-- WEEKLY REPORT -->
    <section class="section-anchor d-none" id="page-weekly-report">
     <div class="d-flex align-items-center mb-4">
      <h1 class="h3 mb-0">
       <i class="bi bi-calendar-week me-2">
       </i>
       Weekly Report
      </h1>
      <div class="ms-auto">
       <button class="btn btn-primary" id="btnAddWeeklyReport" type="button">
        <i class="bi bi-plus-lg me-1">
        </i>
        Tạo b&aacute;o c&aacute;o tuần
       </button>
      </div>
     </div>
     <div class="d-none" id="weeklyReportFormWrap">
     </div>
     <div class="card card-shadow">
      <div class="card-body table-responsive">
       <table class="table table-hover table-sm align-middle">
        <thead class="table-light">
         <tr>
          <th>
           Tuần
          </th>
          <th>
           Người b&aacute;o c&aacute;o
          </th>
          <th>
           Tasks ho&agrave;n th&agrave;nh
          </th>
          <th>
           Tổng thời gian (h)
          </th>
          <th>
           &Dstrok;ề xuất
          </th>
          <th>
           Ng&agrave;y tạo
          </th>
          <th style="width:120px;">
           Actions
          </th>
         </tr>
        </thead>
        <tbody id="weeklyReportTbody">
        </tbody>
       </table>
      </div>
     </div>
    </section>
    <!-- USER SUMMARY -->
    <section class="section-anchor d-none" id="page-user-summary">
     <div class="d-flex align-items-center mb-4">
      <h1 class="h3 mb-0">
       <i class="bi bi-person-check me-2">
       </i>
       My Tasks Summary
      </h1>
     </div>
     <div class="row g-4 mb-4">
      <div class="col-12 col-md-4">
       <div class="card card-shadow">
        <div class="card-body text-center">
         <h3 class="fw-bold text-warning" id="myTasksPending">
          0
         </h3>
         <p class="mb-0">
          Pending Tasks
         </p>
        </div>
       </div>
      </div>
      <div class="col-12 col-md-4">
       <div class="card card-shadow">
        <div class="card-body text-center">
         <h3 class="fw-bold text-primary" id="myTasksInProgress">
          0
         </h3>
         <p class="mb-0">
          In Progress Tasks
         </p>
        </div>
       </div>
      </div>
      <div class="col-12 col-md-4">
       <div class="card card-shadow">
        <div class="card-body text-center">
         <h3 class="fw-bold text-success" id="myTasksCompleted">
          0
         </h3>
         <p class="mb-0">
          Completed Tasks
         </p>
        </div>
       </div>
      </div>
     </div>
     <div class="card card-shadow">
      <div class="card-body">
       <h6 class="text-secondary text-uppercase mb-3">
        My Tasks
       </h6>
       <div class="table-responsive">
        <table class="table table-hover table-sm align-middle">
         <thead class="table-light">
          <tr>
           <th>
            Task Name
           </th>
           <th>
            Project
           </th>
           <th>
            Deadline
           </th>
           <th>
            Status
           </th>
           <th>
            Progress
           </th>
          </tr>
         </thead>
         <tbody id="myTasksTbody">
         </tbody>
        </table>
       </div>
      </div>
     </div>
    </section>
    <!-- PROJECT SUMMARY -->
    <section class="section-anchor d-none" id="page-project-summary">
     <div class="d-flex align-items-center mb-4">
      <h1 class="h3 mb-0">
       <i class="bi bi-graph-up me-2">
       </i>
       Project Summary
      </h1>
     </div>
     <div class="row g-4 mb-4">
      <div class="col-12">
       <div class="card card-shadow">
        <div class="card-body">
         <h6 class="text-secondary text-uppercase mb-3">
          Project Overview
         </h6>
         <div class="table-responsive">
          <table class="table table-hover table-sm align-middle">
           <thead class="table-light">
            <tr>
             <th>
              Dự &aacute;n
             </th>
             <th>
              Kh&aacute;ch h&agrave;ng
             </th>
             <th>
              Tổng Tasks
             </th>
             <th>
              Ho&agrave;n th&agrave;nh
             </th>
             <th>
              &Dstrok;ang thực hiện
             </th>
             <th>
              Pending
             </th>
             <th>
              Progress
             </th>
             <th>
              Status
             </th>
            </tr>
           </thead>
           <tbody id="projectSummaryTbody">
           </tbody>
          </table>
         </div>
        </div>
       </div>
      </div>
     </div>
    </section>
   </div>
  </main>
  <!-- ========================= SCRIPTS ========================= -->
  <script crossorigin="anonymous" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js">
  </script>
  <script defer="True" src="app.js">
  </script>
 </body>
</html>
